<div class="importDatabase">
    <div class="panel">
        <div class="panel-body">
            <form class="flex-form" data-bind="submit: nextStep, if: inFirstStep">
                <h3>Import documents from a SQL database into the current RavenDB database</h3>
                <div class="row">
                    <div class="col-sm-8 col-lg-6 margin-top" data-bind="with: model">
                        <div class="form-group">
                            <div>
                                <label class="control-label">SQL database driver</label>
                            </div>
                            <div class="flex-grow">
                                <button class="btn btn-block dropdown-toggle text-left" data-toggle="dropdown">
                                    <span data-bind="text: labelForProvider(databaseType())"></span>
                                    <span class="caret"></span>
                                </button>
                                <ul class="dropdown-menu" data-bind="foreach: $data.constructor.possibleProviders">
                                    <li><a href="#"
                                           data-bind="text: $parent.labelForProvider($data), click: $parent.databaseType.bind($parent.databaseType, $data)"></a>
                                    </li>
                                </ul>
                                <span class="help-block" data-bind="validationMessage: databaseType"></span>
                            </div>
                        </div>
                        <div data-bind="visible: databaseType() === 'MsSQL', with: sqlServer">
                            <div class="form-group"
                                 data-bind="validationElement: connectionString">
                                <label class="control-label">Connection string<i class="required"></i></label>
                                <div class="flex-grow">
                                    <textarea class="form-control"
                                              data-bind="textInput: connectionString" rows="3"
                                              title="The connection string for the SQL server"
                                              placeholder="Enter the complete connection string for the SQL server">                                        
                                    </textarea>
                                    <div>
                                        <small>
                                            <i class="icon-info"></i>
                                            Please provide 'Database name' in the field below, instead of using <code>Initial Catalog</code> option. 
                                        </small>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div data-bind="visible: databaseType() === 'MySQL', with: mySql">
                            <div class="form-group" data-bind="validationElement: server">
                                <label class="control-label">Server location<i class="required"></i></label>
                                <div class="flex-grow">
                                    <input class="form-control"
                                           data-bind="textInput: server"
                                           placeholder="Server location">
                                </div>
                            </div>
                            <div class="form-group" data-bind="validationElement: username,">
                                <label class="control-label">Username<i class="required"></i></label>
                                <div class="flex-grow">
                                    <input class="form-control"
                                           data-bind="textInput: username"
                                           placeholder="Username">
                                </div>
                            </div>
                            <div class="form-group" data-bind="validationElement: password">
                                <label class="control-label">Password</label>
                                <div class="flex-grow">
                                    <input type="password" class="form-control"
                                           data-bind="textInput: password"
                                           placeholder="Password">
                                </div>
                            </div>
                        </div>
                        <div class="form-group" data-bind="validationElement: sourceDatabaseName">
                            <label class="control-label">SQL Database name<i class="required"></i></label>
                            <div class="flex-grow">
                                <input class="form-control"
                                       data-bind="textInput: sourceDatabaseName"
                                       placeholder="Enter the SQL Database name">
                            </div>
                        </div>
                    </div>
                </div>
                <hr/>
                <div class="alert alert-warning">
                    If user goes back to this view offer an option to continue previous setup
                </div>
                <hr/>
                <div class="form-group">
                    <div class="col-sm-10">
                        <button class="btn btn-primary" type="submit" 
                                data-bind="disable: $root.spinners.schema, css: { 'btn-spinner': $root.spinners.schema }">
                            <span class="icon-import"></span> <span>Continue</span>
                        </button>
                    </div>
                </div>
            </form>
            <div data-bind="if: !inFirstStep()">
                
                <button class="btn btn-primary" data-bind="click: $root.migrate">Migrate</button>
                
                <div data-bind="foreach: model.tables">
                    <div class="checkbox" data-placement="left">
                        <input type="checkbox" data-bind="checked: checked, attr: { id: 'table_' + $index() }" />
                        <label data-bind="text: name, attr: { for: 'table_' + $index() }"></label>
                    </div>
                    
                    <div>Document ID: <span data-bind="text: documentIdTemplate"></span></div>
                    
                    <div>Properties:</div>
                    <ul data-bind="foreach: documentColumns">
                        <li data-bind="text: propertyName() + ' (' + type + ')'"></li>
                    </ul>
                    
                    <div>References:</div>
                    
                    <ul data-bind="foreach: references">
                        <li>
                            <span data-bind="text: name"></span> | 
                            <span data-bind="text: joinColumns.join(', ')"></span> | 
                            <span data-bind="text: targetTable.tableName"></span> | 
                            <span data-bind="text: type"></span> 
                            
                            <div class="btn-group">
                                <button class="btn btn-sm" data-bind="css: { active: action() === 'skip' }, click: _.partial($root.onActionClicked, $data, 'skip')">skip</button>
                                <button class="btn btn-sm" data-bind="css: { active: action() === 'link' }, click: _.partial($root.onActionClicked, $data, 'link')">link</button>
                                <button class="btn btn-sm" data-bind="css: { active: action() === 'embed' }, click: _.partial($root.onActionClicked, $data, 'embed')">embed</button>
                            </div>
                            
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
