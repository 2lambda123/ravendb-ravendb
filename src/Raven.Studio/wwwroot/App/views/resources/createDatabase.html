<div class="modal-dialog" role="document" id="newDatabase" data-bind="css: { 'modal-lg': showWideDialog(), 'modal-sm': !showWideDialog() }">
    <form data-bind="submit: createResource" autocomplete="off">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" data-bind="click: close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="newDatabaseLabel">New database</h4>
            </div>
            <div class="modal-body">
                <div class="modal-settings-panel">
                    <div class="modal-settings-panel-main">
                        <div class="form-group" data-bind="validationElement: resourceModel.name">
                            <h3>NAME</h3>
                            <input type="text" id="resourceName" data-bind="textInput: resourceModel.name" autofocus class="form-control">
                        </div>
                        <h3>BUNDLES</h3>
                        <div class="settings-group" data-bind="foreach: getAvailableBundles()">
                            <div class="checkbox settings-item" data-bind="css: { 'active': $root.advancedBundleConfigurationVisible() === name }">
                                <input class="styled" type="checkbox" data-bind="checked: $root.resourceModel.activeBundles, checkedValue: name, attr: { id: 'bundle_' + $index() }">
                                <label data-bind="text: displayName, attr: { 'for': 'bundle_' + $index() }"></label>
                                <button type="button" class="btn pull-right btn-toggle"
                                        data-bind="visible: hasAdvancedConfiguration, click: $root.showAdvancedConfigurationFor.bind($root, name), css: { 'btn-danger': validationGroup && !validationGroup.isValid() }">
                                    <i data-bind="attr: { 'class' : validationGroup && !validationGroup.isValid() ? 'icon-danger' : 'icon-settings' }"></i>
                                </button>
                            </div>
                        </div>
                        <button type="button"
                                data-bind="click: showAdvancedConfiguration, attr: { 'class': 'btn btn-block btn-toggle ' + (resourceModel.advancedValidationGroup.isValid() ? 'btn-info' : 'btn-danger')  }">
                            <i data-bind="attr: { 'class': resourceModel.advancedValidationGroup.isValid() ? 'icon-settings' : 'icon-danger' }"></i><span>Advanced</span>
                        </button>
                    </div>
                    <div class="modal-settings-panel-slideout">
                        <div>
                            <div class="advanced" data-bind="template: { name: 'create-db-advanced' }, visible: advancedConfigurationVisible()">
                            </div>
                        </div>
                        <div data-bind="if: bundlesEnabled.quotas()">
                            <div class="quotas" data-bind="template: { name: 'create-db-quotas' }, visible: advancedVisibility.quotas()">
                            </div>
                        </div>
                        <div data-bind="if: bundlesEnabled.encryption()">
                            <div class="encryption" data-bind="template: { name: 'create-db-encryption' }, visible: advancedVisibility.encryption()">
                            </div>
                        </div>
                        <div data-bind="if: bundlesEnabled.versioning()">
                            <div class="versioning" data-bind="template: { name: 'create-db-versioning' }, visible: advancedVisibility.versioning()">
                            </div>
                        </div>
                        <div data-bind="if: bundlesEnabled.sqlReplication()">
                            <div class="sqlreplication" data-bind="template: { name: 'create-db-sql-replication' }, visible: advancedVisibility.sqlReplication()">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="submit" class="btn btn-success btn-block"><i class="icon-plus"></i><span>Create</span></button>
            </div>
        </div>
    </form>
</div>


<script type="text/html" id="create-db-advanced">
    <h3>ADVANCED</h3>
    <div class="form-group row" data-bind="validationElement: resourceModel.dataPath">
        <div class="col-md-4">
            <label class="control-label">Path</label>
        </div>
        <div class="col-md-8">
            <input type="text" class="form-control" data-bind="textInput: resourceModel.dataPath, attr: { placeholder: '~/' + resourceModel.name() }" />
        </div>
    </div>
    <div class="form-group row" data-bind="validationElement: resourceModel.journalsPath">
        <div class="col-md-4">
            <label class="control-label">Journals</label>
        </div>
        <div class="col-md-8">
            <input type="text" class="form-control" data-bind="textInput: resourceModel.journalsPath, attr: { placeholder: '~/' + resourceModel.name() }" />
        </div>
    </div>
    <div class="form-group row" data-bind="validationElement: resourceModel.indexesPath">
        <div class="col-md-4">
            <label class="control-label">Indexes</label>
        </div>
        <div class="col-md-8">
            <input type="text" class="form-control" data-bind="textInput: resourceModel.indexesPath, attr: { placeholder: indexesPathPlaceholder() }" />
        </div>
    </div>
    <div class="form-group row" data-bind="validationElement: resourceModel.tempPath">
        <div class="col-md-4">
            <label class="control-label">Temp</label>
        </div>
        <div class="col-md-8">
            <input type="text" class="form-control" data-bind="textInput: resourceModel.tempPath, attr: { placeholder: '~/' + resourceModel.name() }" />
        </div>
    </div>
    <div class="checkbox">
        <input id="check-incremental-backup" class="styled" type="checkbox" data-bind="checked: resourceModel.incrementalBackup">
        <label for="check-incremental-backup">Incremental Backup</label>
    </div>
    <div data-bind="visible: resourceModel.incrementalBackup()">
        <div class="form-group row">
            <div class="col-md-4">
                <label>Alert timeout</label>
            </div>
            <div class="col-md-8">
                <div class="btn-group btn-block">
                    <button type="button" class="btn btn-block dropdown-toggle" data-toggle="dropdown" title="Sets the span of time allowed before issuing an alert for missing backup (in hours).">
                        <span data-bind="text: $root.pluralize(resourceModel.incrementalBackupSettings.alertTimeout(), 'hour', 'hours')"></span>
                        <span class="caret"></span>
                    </button>
                    <ul class="dropdown-menu" role="menu" data-bind="foreach: resourceModel.alertTimeoutOptions">
                        <li><a href="#" data-bind="text: $data, click: $root.resourceModel.setAlertTimeout.bind($root.resourceModel, $data)"></a></li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="form-group row">
            <div class="col-md-4">
                <label>Alert recurring timeout</label>
            </div>
            <div class="col-md-8">
                <div class="btn-group btn-block">
                    <button type="button" class="btn btn-block dropdown-toggle" data-toggle="dropdown" title="Sets the span of time allowed before issuing multiple alerts on the same missed backup (in days).">
                        <span data-bind="text: $root.pluralize(resourceModel.incrementalBackupSettings.alertRecurringTimeout(), 'day', 'days')"></span>
                        <span class="caret"></span>
                    </button>
                    <ul class="dropdown-menu" role="menu" data-bind="foreach: resourceModel.alertRecurringTimeoutOptions">
                        <li><a href="#" data-bind="text: $data, click: $root.resourceModel.setRecurringAlertTimeout.bind($root.resourceModel, $data)"></a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</script>

<script type="text/html" id="create-db-quotas">
    <h3>QUOTAS</h3>
    <div class="form-group row">
        <div class="col-md-6">
            <label>Maximum size:</label>
        </div>
        <div class="col-md-6">
            <div class="input-group">
                <input required="" type="number" class="form-control" min="0"> <span class="input-group-addon">MB</span>
            </div>
        </div>
    </div>
    <div class="form-group row">
        <div class="col-md-6">
            <label>Warning limit threshold:</label>
        </div>
        <div class="col-md-6">
            <div class="input-group">
                <input required="" type="number" class="form-control" min="0"> <span class="input-group-addon">MB</span>
            </div>
        </div>
    </div>
    <div class="form-group row">
        <div class="col-md-6">
            <label>Maximum number of docs:</label>
        </div>
        <div class="col-md-6">
            <div class="input-group">
                <input required="" type="number" class="form-control" min="0">
                <span class="input-group-addon">docs</span>
            </div>
        </div>
    </div>
    <div class="form-group row">
        <div class="col-md-6">
            <label>Warning threshold for docs:</label>
        </div>
        <div class="col-md-6">
            <div class="input-group">
                <input required="" type="number" class="form-control" min="0">
                <span class="input-group-addon">docs</span>
            </div>
        </div>
    </div>
</script>

<script type="text/html" id="create-db-encryption">
    <div class="form-group row" data-bind="validationElement: resourceModel.encryption.key">
        <div class="col-md-6">
            <label class="control-label">
                Select Key <small class="text-muted">(Base64 Encoding)</small>
            </label>
        </div>
        <div class="col-md-6">
            <div class="input-group">
                <input type="text" class="form-control" placeholder="Key" autocomplete="off"
                       data-bind="textInput: resourceModel.encryption.key">
                <span class="input-group-btn">
                    <button class="btn btn-default" type="button" data-bind="click: resetEncryptionKey">
                        <i class="icon-reset"></i>
                    </button>
                </span>
            </div>
        </div>
        <div class="col-sm-12">
            <p class="bg-info padding padding-sm small">
                <i class="icon-warning"></i> Save this key in a safe place. If you lose this key you could lose access to your data.
            </p>
        </div>
    </div>
    <div class="form-group row">
        <div class="col-md-6">
            <label>Encryption Algorithm</label>
        </div>
        <div class="col-md-6">
            <div class="btn-group btn-block">
                <button type="button" class="btn btn-block dropdown-toggle" data-toggle="dropdown">
                    <span data-bind="text: resourceModel.encryption.algorithm"></span>
                    <span class="caret"></span>
                </button>
                <ul class="dropdown-menu" role="menu" data-bind="foreach: resourceModel.encryptionAlgorithmsOptions">
                    <li><a href="#" data-bind="text: $data, click: $root.resourceModel.setEncryptionAlgorithm.bind($root.resourceModel, $data)"></a></li>
                </ul>
            </div>
        </div>
    </div>
    <div class="form-group row">
        <div class="col-md-6">
            <label>Encryption Key Bits</label>
        </div>
        <div class="col-md-6">
            <div class="btn-group btn-block">
                <button type="button" class="btn btn-block dropdown-toggle" data-toggle="dropdown">
                    <span data-bind="text: resourceModel.encryption.keyBitsPreference"></span>
                    <span class="caret"></span>
                </button>
                <ul class="dropdown-menu" role="menu" data-bind="foreach: resourceModel.encryptionKeyBitsOptions">
                    <li><a href="#" data-bind="text: $data, click: $root.resourceModel.setEncryptionBits.bind($root.resourceModel, $data)"></a></li>
                </ul>
            </div>
        </div>
    </div>
    <div class="form-group row">
        <div class="col-md-6">
            <label class="control-label">Indexes</label>
        </div>
        <div class="col-md-6">
            <div class="btn-group btn-block">
                <button type="button" class="btn btn-block dropdown-toggle" data-toggle="dropdown">
                    <span data-bind="text: resourceModel.encryption.encryptIndexes() ? 'Encrypt' : 'Do not encrypt'">Encrypt</span>
                    <span class="caret"></span>
                </button>
                <ul class="dropdown-menu" role="menu" data-bind="with: resourceModel">
                    <li><a href="#" data-bind="click: setIndexEncryption.bind($data, true)">Encrypt</a></li>
                    <li><a href="#" data-bind="click: setIndexEncryption.bind($data, false)">Do not encrypt</a></li>
                </ul>
            </div>
        </div>
    </div>
</script>

<script type="text/html" id="create-db-versioning">
    <h3>VERSIONING</h3>
    <div class="form-group">
        <button class="btn btn-default">
            <i class="icon-plus"></i>
            <span>Add versioning</span>
        </button>
    </div>
    <div class="panel panel-default">
        <div class="panel-heading">
            <button class="icon-trash text-primary right-action-button"></button>
            <h3 class="panel-title">Versioning setup for DefaultConfiguration</h3>
        </div>
        <div class="panel-body">
            <div class="form-group row">
                <div class="col-sm-6">
                    <label>Override:</label>
                </div>
                <div class="col-sm-6">
                    <div class="btn-group btn-block">
                        <button type="button" class="btn dropdown-toggle btn-block" data-toggle="dropdown">
                            <span>Yes</span>
                            <span style="display: none;">No</span>
                            <span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu" role="menu">
                            <li><a href="#">Yes</a></li>
                            <li><a href="#">No</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="form-group row">
                <div class="col-sm-6">
                    <label>Collection</label>
                </div>
                <div class="col-sm-6">
                    <input required="" type="text" class="form-control">
                </div>
            </div>
            <div class="form-group row">
                <div class="col-sm-6">
                    <label>Max Revisions</label>
                </div>
                <div class="col-sm-6">
                    <input required="" type="number" class="form-control">
                </div>
            </div>
            <div class="form-group row">
                <div class="col-sm-6">
                    <label>Excluded</label>
                </div>
                <div class="col-sm-6">
                    <div class="btn-group btn-block">
                        <button type="button" class="btn btn-block dropdown-toggle" data-toggle="dropdown">
                            <span>Include</span>
                            <span style="display: none;">Exclude</span>
                            <span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu" role="menu">
                            <li><a href="#">Include</a></li>
                            <li><a href="#">Exclude</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="form-group row">
                <label class="col-sm-6 control-label">Exclude unless explicit</label>
                <div class="col-sm-6">
                    <div class="btn-group btn-block">
                        <button type="button" class="btn btn-block dropdown-toggle" data-toggle="dropdown">
                            <span>Include</span>
                            <span style="display: none;">Exclude</span>
                            <span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu" role="menu">
                            <li><a href="#">Include</a></li>
                            <li><a href="#">Exclude</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="checkbox">
                <input id="check-purge-on-delete" class="styled" type="checkbox">
                <label for="check-purge-on-delete">Purge on delete</label>
            </div>
        </div>
    </div>
</script>

<script type="text/html" id="create-db-sql-replication">
    <h3>SQL Replication Connection Strings</h3>
    <div class="form-group">
        <button class="btn btn-default">
            <i class="icon-plus"></i>
            <span>New connection string</span>
        </button>
    </div>
    <div class="sql-replication-connection-card panel panel-default">
        <div class="panel-heading">
            <h3 class="panel-title">
                <button class="icon-trash text-primary right-action-button"></button>
                <span title="Overridden from global configuration" style="display: none;">
                    <i class="fa fa-arrow-down"></i>
                </span>
                <span>new</span>
                <button type="button" class="close" aria-hidden="true" title="Remove this connection"><i class="fa fa-times"></i></button>
            </h3>
        </div>
        <div class="panel-body">
            <div class="form-group row">
                <div class="col-md-4">
                    <label>Name</label>
                </div>
                <div class="col-md-8">
                    <input required="" name="name" class="form-control" type="text">
                </div>
            </div>
            <div class="form-group row">
                <div class="col-md-4">
                    <label>SQL Provider</label>
                </div>
                <div class="col-md-8">
                    <div class="dropdown">
                        <button class="btn dropdown-toggle btn-block" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                            Select provider
                            <span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu">
                            <li><a href="#" value="System.Data.SqlClient">System.Data.SqlClient</a></li>
                            <li><a href="#" value="System.Data.SqlServerCe.4.0">System.Data.SqlServerCe.4.0</a></li>
                            <li><a href="#" value="System.Data.OleDb">System.Data.OleDb</a></li>
                            <li><a href="#" value="System.Data.OracleClient">System.Data.OracleClient</a></li>

                            <li><a href="#" value="MySql.Data.MySqlClient">MySql.Data.MySqlClient</a></li>
                            <li><a href="#" value="System.Data.SqlServerCe.3.5">System.Data.SqlServerCe.3.5</a></li>
                            <li><a href="#" value="Npgsql">Npgsql</a></li>

                        </ul>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label>Connection String</label>
                <textarea tabindex="6" rows="4" required="" class="form-control"></textarea>
            </div>
            <div class="form-group">

                <button type="button" class="btn btn-default btn-block">Test connection</button>

                <div class="progress progress-striped">
                    <div class="progress-bar progress-bar-primary" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%; float: left;">
                        <span class="sr-only">Connected</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</script>