<div class="resources" data-bind="css: { 'resources_compact': compactView() }">
    <div class="resourcesToolbar clearfix">
        <div class="form-inline">
            <div class="checkbox checkbox-inline align-checkboxes">
                <input type="checkbox" class="styled" data-bind="checkboxTriple: selectionState, event: { change: toggleSelectAll }">
                <label></label>
            </div>
            <div class="resourcesToolbar-typeSelector btn-group">
                <button class="btn btn-default" data-bind="css: { active: filters.includeDatabases() }, click: filters.includeDatabases.toggle.bind(filters.includeDatabases)">
                    <i class="icon-database"></i>
                    <span>
                        Databases
                    </span>
                    <span class="badge" data-bind="text: resources().databasesCount(), visible: resources().databasesCount()"></span>
                </button>
                <!--
                <button class="btn btn-default" data-bind="css: { active: filters.includeFilesystems() }, click: filters.includeFilesystems.toggle.bind(filters.includeFilesystems)">
                    <i class="icon-filesystem"></i>
                    <span>
                        Filesystems
                    </span>
                    <span class="badge" data-bind="text: resources().filesystemCount(), visible: resources().filesystemCount()"></span>
                </button>
                -->
            </div>
            <input type="text" class="form-control" placeholder="Filter" accesskey="/"  title="Filter resources (Alt+/)" data-bind="textInput: filters.searchText">
            <div class="resourcesToolbar-actions">
                <button class="btn btn-danger" data-bind="visible: isGlobalAdmin(), enable: selectedResources().length, click: deleteSelectedResources">
                    <i class="icon-trash"></i>
                    <span>Delete</span>
                </button>
                <button type="button" class="btn btn-default" data-bind="enable: selectedResources().length && !spinners.globalToggleDisable(), click: toggleSelectedResources(), css: { 'btn-spinner': spinners.globalToggleDisable() }">
                    <i data-bind="visible: !allCheckedResourcesDisabled()" class="icon-lock"></i>
                    <span data-bind="visible: !allCheckedResourcesDisabled()">Disable</span>
                    <i data-bind="visible: allCheckedResourcesDisabled()" class="icon-unlock"></i>
                    <span data-bind="visible: allCheckedResourcesDisabled()">Enable</span>
                </button>
            </div>
            <div class="toggle toggle-primary resourcesToolbar-toggleCompactView pull-right">
                <input id="compactViewInput" name="compactView" class="styled" type="checkbox" data-bind="checked: $root.compactView" />
                <label for="compactViewInput">
                    Compact View
                </label>
            </div>
        </div>
    </div>
    <hr />    
    
    <div data-bind="foreach: resources().sortedResources">
        <div class="panel resource" data-bind="visible: !filteredOut(), css: { 'panel-success': isCurrentlyActiveResource() }">
            <div class="padding padding-sm">
                <div data-bind="attr: { 'data-state-text': badgeText, class: 'state ' + badgeClass() }"></div>
                <div class="row">
                    <div class="col-xs-12 col-sm-6 col-xl-4 info-container">
                        <div class="checkbox">
                            <input type="checkbox" class="styled" data-bind="checked: $root.selectedResources, checkedValue: qualifiedName">
                            <label></label>
                        </div>
                        <h3 class="resource-name">
                            <i class="icon-database text-danger"></i>
                            <span data-bind="visible: !canNavigateToResource(), text: name"></span>
                            <a data-bind="attr: { title: name, href: $root.resourceUrl($data) }, text: name, visible: canNavigateToResource()" href="#"></a>
                        </h3>
                    </div>
                    <div class="col-xs-12 col-sm-12 col-xl-6 vertical-divider properties-container" data-bind="template: { name: 'properties-template' }, visible: online()">

                    </div>
                    <div data-bind="visible: !online()" class="col-xs-12 col-sm-12 col-xl-6 vertical-divider properties-container">
                    </div>
                    <div class="col-xs-12 col-sm-6 col-xl-2 actions-container">
                        <div class="actions">
                            <div class="btn-toolbar pull-right-sm" role="toolbar">
                                <div class="btn-group">
                                    <button class="btn btn-default"
                                            data-bind="visible: !online() && !disabled(), click: $root.loadResource.bind($root, $data), css: { 'btn-spinner': $root.spinners.resourceLoad().contains(qualifiedName) }, enable: !$root.spinners.resourceLoad().contains(qualifiedName)">
                                        <i class="icon-load" ></i>
                                        <span>Load</span>
                                    </button>
                                    <button class="btn btn-default"
                                            data-bind="click: $root.toggleResource.bind($root, $data), css: { 'btn-spinner': $root.spinners.itemTakedowns().contains(qualifiedName) }, enable: !$root.spinners.itemTakedowns().contains(qualifiedName), visible: online() || disabled()">

                                        <i class="icon-unlock" data-bind="visible: disabled()"></i>
                                        <span data-bind="visible: disabled()">Enable</span>

                                        <i class="icon-lock" data-bind="visible: !disabled()"></i>
                                        <span data-bind="visible: !disabled()">Disable</span>

                                    </button>
                                    <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                        <span class="caret"></span>
                                        <span class="sr-only">Toggle Dropdown</span>
                                    </button>
                                    <ul class="dropdown-menu">
                                        <li data-bind="visible: online() && indexingEnabled()">
                                            <a href="#" data-bind="click: $root.toggleDatabaseIndexing.bind($root, $data)">
                                                <i class="icon-pause"></i> Disable indexing
                                            </a>
                                        </li>
                                        <li data-bind="visible: online() && !indexingEnabled()">
                                            <a href="#" data-bind="click: $root.toggleDatabaseIndexing.bind($root, $data)">
                                                <i class="icon-play"></i> Enable indexing
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" data-bind="click: $root.toggleRejectDatabaseClients.bind($root, $data)">
                                                <i class="icon-umbrella"></i> Reject clients mode
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                                <button class="btn btn-danger" data-bind="click: $root.deleteResource.bind($root, $data)">
                                    <i class="icon-trash"></i>
                                    <span>Delete</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script type="text/html" id="properties-template">
    <div class="properties-item" data-bind="visible: totalSize">
        <div class="properties-value value-only">
            <div class="set-size">
                <i class="icon-drive"></i>
                <span data-bind="text: totalSize"></span>
            </div>
        </div>
    </div>

    <div class="properties-item" data-bind="visible: $data.qualifier === 'db' && documentsCount(), if: $data.qualifier === 'db'">
        <div class="properties-value value-only">
            <div class="set-size">
                <i class="icon-document-group"></i>
                <span data-bind="text: $root.pluralize(documentsCount(), 'document', 'documents')"></span>
            </div>
        </div>
    </div>

    <div class="properties-item" data-bind="visible: $data.qualifier === 'db' && indexesCount(), if: $data.qualifier === 'db'">
        <div class="properties-value value-only">
            <div class="set-size">
                <i class="icon-index"></i>
                <span data-bind="text: $root.pluralize(indexesCount(), 'index', 'indexes')"></span>
            </div>
        </div>
    </div>

    <div class="properties-item" data-bind="visible: $data.qualifier === 'fs' && filesCount(), if: $data.qualifier === 'fs'">
        <div class="properties-value value-only">
            <div class="set-size">
                <i class="icon-filesystem"></i>
                <span data-bind="text: $root.pluralize(filesCount(), 'file', 'files')"></span>
            </div>
        </div>
    </div>

    <div class="properties-item" data-bind="visible: errors()">
        <div class="properties-value value-only text-danger">
            <div class="set-size">
                <i class="icon-exclamation"></i>
                <span data-bind="text: $root.pluralize(errors(), 'error', 'errors')"></span>
            </div>
        </div>
    </div>

    <div class="properties-item" data-bind="visible: alerts()">
        <div class="properties-value value-only text-warning">
            <div class="set-size">
                <i class="icon-warning"></i>
                <span data-bind="text: $root.pluralize(alerts(), 'alert', 'alerts')"></span>
            </div>
        </div>
    </div>

    <div class="properties-item" data-bind="visible: backupEnabled()">
        <div data-bind="attr: { class: 'properties-value value-only ' + backupStatus() }">
            <div class="set-size">
                <i class="icon-backup"></i>
                <span data-bind="text: 'Backed up ' + lastBackup(), visible: backupStatus() !== 'text-danger'"></span>
                <span data-bind="visible: backupStatus() === 'text-danger'">
                    Never backed up
                </span>
            </div>
        </div>
    </div>

    <div class="properties-item" data-bind="visible: uptime()">
        <div class="properties-value value-only ">
            <div class="set-size">
                <i class="icon-recent"></i>
                <span data-bind="text: 'Up for ' + uptime()"></span>
            </div>
        </div>
    </div>

    <div class="properties-item" data-bind="visible: !indexingEnabled()">
        <div class="properties-value value-only text-warning">
            <div class="set-size">
                <i class="icon-pause"></i>
                <span>Indexing disabled</span>
            </div>
        </div>
    </div>

    <div class="properties-item" data-bind="visible: rejectClients()">
        <div class="properties-value value-only text-warning">
            <div class="set-size">
                <i class="icon-umbrella"></i>
                <span>Clients rejection mode</span>
            </div>
        </div>
    </div>
</script>